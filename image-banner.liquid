{%- comment -%}
- Shopify Native Section, which was updated with the ability to add an app block for reviews 
- Code change was primarily to inject the option of an App Block within this section. 
- App block also works for Klaviyo for sign-ups, as it was on PageFly x Kit set up. 
{%- endcomment -%}

{{ 'section-image-banner.css' | asset_url | stylesheet_tag }}

{%- if section.settings.image_height == 'adapt' and section.settings.image != blank -%}
  {%- style -%}
    @media screen and (max-width: 749px) {
      #Banner-{{ section.id }}::before,
      #Banner-{{ section.id }} .banner__media::before,
      #Banner-{{ section.id }}:not(.banner--mobile-bottom) .banner__content::before {
        padding-bottom: {{ 1 | divided_by: section.settings.image.aspect_ratio | times: 100 }}%;
        content: '';
        display: block;
      }
    }

    @media screen and (min-width: 750px) {
      #Banner-{{ section.id }}::before,
      #Banner-{{ section.id }} .banner__media::before {
        padding-bottom: {{ 1 | divided_by: section.settings.image.aspect_ratio | times: 100 }}%;
        content: '';
        display: block;
      }
    }
  {%- endstyle -%}
{%- endif -%}

{%- style -%}
  #Banner-{{ section.id }}::after {
    opacity: {{ section.settings.image_overlay_opacity | divided_by: 100.0 }};
  }
{%- endstyle -%}

{%- liquid
  assign full_width = '100vw'
  assign widths = '375, 550, 750, 1100, 1500, 1780, 2000, 3000, 3840'
-%}

<div
  id="Banner-{{ section.id }}"
  class="banner banner--content-align-{{ section.settings.desktop_content_alignment }} banner--content-align-mobile-{{ section.settings.mobile_content_alignment }} banner--{{ section.settings.image_height }}{% if section.settings.image_height == 'adapt' and section.settings.image != blank %} banner--adapt{% endif %}{% if section.settings.show_text_below %} banner--mobile-bottom{%- endif -%}{% if section.settings.show_text_box == false %} banner--desktop-transparent{% endif %}"
>
  {%- if section.settings.image != blank -%}
    <div class="banner__media media">
      {{
        section.settings.image
        | image_url: width: 3840
        | image_tag:
          widths: widths,
          sizes: full_width
      }}
    </div>
  {%- else -%}
    <div class="banner__media media placeholder">
      {{ 'hero-apparel-1' | placeholder_svg_tag: 'placeholder-svg' }}
    </div>
  {%- endif -%}
  <div class="banner__content banner__content--{{ section.settings.desktop_content_position }} page-width">
    <div class="banner__box content-container color-{{ section.settings.color_scheme }} gradient">
      {%- assign embed_rendered = false -%}
      {%- for block in section.blocks -%}
        {%- case block.type -%}
          {%- when 'heading' -%}
            <h2 class="banner__heading inline-richtext {{ block.settings.heading_size }}" {{ block.shopify_attributes }}>
              {{ block.settings.heading }}
            </h2>
          {%- when 'text' -%}
            <div class="banner__text rte {{ block.settings.text_style }}" {{ block.shopify_attributes }}>
              <p>{{ block.settings.text }}</p>
            </div>
          {%- when 'buttons' -%}
            <div class="banner__buttons{% if block.settings.button_label_1 != blank and block.settings.button_label_2 != blank %} banner__buttons--multiple{% endif %}" {{ block.shopify_attributes }}>
              {%- if block.settings.button_label_1 != blank -%}
                <a href="{{ block.settings.button_link_1 }}" class="button{% if block.settings.button_style_secondary_1 %} button--secondary{% else %} button--primary{% endif %}">
                  {{- block.settings.button_label_1 | escape -}}
                </a>
              {%- endif -%}
              {%- if block.settings.button_label_2 != blank -%}
                <a href="{{ block.settings.button_link_2 }}" class="button{% if block.settings.button_style_secondary_2 %} button--secondary{% else %} button--primary{% endif %}">
                  {{- block.settings.button_label_2 | escape -}}
                </a>
              {%- endif -%}
            </div>
          {%- when '@app' -%}
              <div class="banner__app-block" {{ block.shopify_attributes }}>
                {%- render block -%}
              </div>
          {%- when 'embed' -%}
            {%- if embed_rendered == false -%}
             <div class="banner__embed" {{ block.shopify_attributes }}>
              {{ block.settings.embed_code }}
             </div>
          {%- assign embed_rendered = true -%}
              {%- endif -%}
        {%- endcase -%}
      {%- endfor -%}
    </div>
  </div>
</div>


{% schema %}
{
  "name": "Image banner",
  "tag": "section",
  "class": "section",
  "settings": [
    { "type": "image_picker", "id": "image", "label": "Image" },
    { "type": "range", "id": "image_overlay_opacity", "min": 0, "max": 100, "step": 10, "unit": "%", "label": "Image overlay opacity", "default": 0 },
    { "type": "select", "id": "image_height", "options": [ { "value": "adapt", "label": "Adapt to image" }, { "value": "small", "label": "Small" }, { "value": "medium", "label": "Medium" }, { "value": "large", "label": "Large" } ], "default": "medium", "label": "Image height" },
    { "type": "select", "id": "desktop_content_position", "options": [ { "value": "top-left", "label": "Top left" }, { "value": "top-center", "label": "Top center" }, { "value": "top-right", "label": "Top right" }, { "value": "middle-left", "label": "Middle left" }, { "value": "middle-center", "label": "Middle center" }, { "value": "middle-right", "label": "Middle right" }, { "value": "bottom-left", "label": "Bottom left" }, { "value": "bottom-center", "label": "Bottom center" }, { "value": "bottom-right", "label": "Bottom right" } ], "default": "middle-center", "label": "Desktop content position" },
    { "type": "checkbox", "id": "show_text_box", "default": true, "label": "Show text box" },
    { "type": "select", "id": "desktop_content_alignment", "options": [ { "value": "left", "label": "Left" }, { "value": "center", "label": "Center" }, { "value": "right", "label": "Right" } ], "default": "center", "label": "Desktop content alignment" },
    { "type": "color_scheme", "id": "color_scheme", "label": "Color scheme", "default": "scheme-1" },
    { "type": "header", "content": "Mobile layout" },
    { "type": "select", "id": "mobile_content_alignment", "options": [ { "value": "left", "label": "Left" }, { "value": "center", "label": "Center" }, { "value": "right", "label": "Right" } ], "default": "center", "label": "Mobile content alignment" },
    { "type": "checkbox", "id": "show_text_below", "default": true, "label": "Show text below image" }
  ],
  "blocks": [
    { "type": "heading", "name": "Heading", "limit": 1, "settings": [ { "type": "inline_richtext", "id": "heading", "default": "Image banner", "label": "Heading" }, { "type": "select", "id": "heading_size", "options": [ { "value": "h2", "label": "Small" }, { "value": "h1", "label": "Medium" }, { "value": "h0", "label": "Large" } ], "default": "h1", "label": "Heading size" } ] },
    { "type": "text", "name": "Text", "limit": 1, "settings": [ { "type": "inline_richtext", "id": "text", "default": "Give customers details about the banner image(s) or content on the template.", "label": "Text" }, { "type": "select", "id": "text_style", "options": [ { "value": "body", "label": "Body" }, { "value": "subtitle", "label": "Subtitle" } ], "default": "body", "label": "Text style" } ] },
    { "type": "buttons", "name": "Buttons", "limit": 1, "settings": [ { "type": "text", "id": "button_label_1", "default": "Button label", "label": "Button label 1" }, { "type": "url", "id": "button_link_1", "label": "Button link 1" }, { "type": "checkbox", "id": "button_style_secondary_1", "default": false, "label": "Use outline button style 1" }, { "type": "text", "id": "button_label_2", "default": "Button label", "label": "Button label 2" }, { "type": "url", "id": "button_link_2", "label": "Button link 2" }, { "type": "checkbox", "id": "button_style_secondary_2", "default": false, "label": "Use outline button style 2" } ] },
    {
  "type": "embed",
  "name": "Embed",
  "limit": 1,
  "settings": [
    {
      "type": "liquid",
      "id": "embed_code",
      "label": "Embed code",
      "info": "Paste your liquid or script embed code here. For example, from KIT, ConvertKit, etc."
    }
  ]
    },
    { "type": "@app" }
  ],
  "presets": [
    {
      "name": "Image banner",
      "blocks": [
        { "type": "heading" },
        { "type": "text" },
        { "type": "buttons" }
      ]
    }
  ]
}
{% endschema %} 
